#include "solver_res_nn.h"
//Auto Generated by train_resnet.py
Eigen::Matrix<float,NNResModel::num_hidden_nodes,NNResModel::num_in_features> NNResModel::weight0;
Eigen::Matrix<float,NNResModel::num_hidden_nodes,1> NNResModel::bias0;
Eigen::Matrix<float,NNResModel::num_hidden_nodes,NNResModel::num_hidden_nodes> NNResModel::weight2;
Eigen::Matrix<float,NNResModel::num_hidden_nodes,1> NNResModel::bias2;
Eigen::Matrix<float,NNResModel::num_out_features,NNResModel::num_hidden_nodes> NNResModel::weight4;
Eigen::Matrix<float,NNResModel::num_out_features,1> NNResModel::bias4;
Eigen::Matrix<float,NNResModel::num_out_features,1> NNResModel::out_mean;
Eigen::Matrix<float,NNResModel::num_out_features,1> NNResModel::out_std;
Eigen::Matrix<float,NNResModel::num_in_features,1> NNResModel::in_mean;
Eigen::Matrix<float,NNResModel::num_in_features,1> NNResModel::in_std;

void NNResModel::load_nn_model(){
weight0 << -0.13948921859264374f, -0.4881463348865509f, -0.05515405535697937f, 0.034213319420814514f, 0.026993131265044212f, -0.16364911198616028f, 0.009317050687968731f, 0.015433725900948048f, 0.05028556287288666f, -0.018277665600180626f, -0.034637171775102615f, 0.013212572783231735f, -0.004837623797357082f, 0.014425395987927914f, -0.004284693393856287f, -0.019706040620803833f, -0.0063921064138412476f, -0.008022120222449303f, 0.0016454934375360608f, -0.0029132827185094357f, -0.011628344655036926f, -0.019741857424378395f, -0.012791125103831291f, -0.0005427053547464311f, -0.01120628509670496f, -0.016114328056573868f, -0.026679178699851036f, -0.006182702258229256f, 0.016665926203131676f, -0.02256467565894127f, -0.01834508590400219f, -0.0054672760888934135f, -0.012627999298274517f, -0.0005751466960646212f, -0.017281504347920418f, -0.04875423386693001f, -0.021484076976776123f, -0.0225334744900465f, -0.03298347443342209f, 0.0116959810256958f, 0.11246314644813538f, -2.619399309158325f, -0.4026809334754944f, 0.06947453320026398f, -0.005391980987042189f, 0.0881667211651802f, -0.20000626146793365f, -0.06742596626281738f, 0.08571802079677582f, -0.15961669385433197f, -0.042115651071071625f, 0.010897854343056679f, -0.0906607136130333f, -0.02383193001151085f, -0.04604585841298103f, -0.04320988431572914f, 0.030227769166231155f, -0.04762352630496025f, -0.008487441577017307f, -0.0564257837831974f, -0.12237677723169327f, -0.09085719287395477f, -0.07185045629739761f, -0.06857718527317047f, -0.030342336744070053f, -0.07672636210918427f, -0.018764492124319077f, -0.03714202716946602f, 0.030629124492406845f, -0.08186326175928116f, -0.015304312109947205f, -0.08684021234512329f, 0.08969666808843613f, -0.02801675908267498f, 0.06010226532816887f, -0.025331873446702957f, 0.12031053006649017f, 0.028459394350647926f, -0.10198512673377991f, 0.09436776489019394f, -0.9964756965637207f, -0.370570570230484f, -0.08639233559370041f, 0.013163220137357712f, -0.04482943192124367f, 0.2619428038597107f, 0.08495338261127472f, -0.01984773948788643f, 0.10969004034996033f, -0.06467609107494354f, 0.050399068742990494f, 0.030330531299114227f, 0.05122768133878708f, 0.024983368813991547f, 4.670768976211548e-05f, -0.010636686347424984f, 0.02374212257564068f, 0.02463962323963642f, 0.04219554364681244f, -0.018588166683912277f, -0.010868930257856846f, 0.0030818283557891846f, 0.030880358070135117f, 0.018479326739907265f, 0.012402941472828388f, 0.005284561775624752f, 0.018984176218509674f, 0.020840510725975037f, -0.003751171985641122f, 0.02405998297035694f, -0.008515899069607258f, 0.012413141317665577f, -0.025213398039340973f, -0.08405585587024689f, 0.09129020571708679f, -0.05107877030968666f, 0.01742817834019661f, 0.0009106304496526718f, -0.026798265054821968f, 0.017196614295244217f, -0.552539050579071f, -0.09926748275756836f, -0.18787026405334473f, -0.04821549355983734f, 0.03696892410516739f, 0.26831766963005066f, 0.02482675015926361f, 0.22672677040100098f, -0.2959238588809967f, 0.2860991060733795f, 0.06251517683267593f, 0.027295297011733055f, -0.06982777267694473f, -0.05412483960390091f, 0.03649981692433357f, 0.018250949680805206f, 0.0006328021991066635f, -0.07443580776453018f, -0.017675839364528656f, -0.002592124743387103f, 0.05737950652837753f, -0.060761045664548874f, -0.06737926602363586f, -0.021233517676591873f, -0.015566915273666382f, -0.027472181245684624f, 0.009098329581320286f, -0.08887553960084915f, 0.06331122666597366f, -0.0580671951174736f, 0.049646634608507156f, -0.011196396313607693f, -0.0698612779378891f, 0.16370634734630585f, -0.19188028573989868f, -0.011402761563658714f, 0.017697766423225403f, -0.0799977034330368f, 0.11789412051439285f, -0.13832923769950867f, 0.16878968477249146f, -3.1561591625213623f, 0.40583696961402893f, 0.018435409292578697f, -0.09989724308252335f, 0.22657161951065063f, -0.418884813785553f, -0.05623411759734154f, 0.05235076695680618f, -0.1702539026737213f, -0.16409632563591003f, 0.20110897719860077f, -0.10068114846944809f, 0.05955679714679718f, -0.1732388138771057f, -0.04618068039417267f, -0.007190738804638386f, -0.17611955106258392f, 0.047824520617723465f, -0.08195821940898895f, -0.03039073944091797f, -0.18030154705047607f, 0.008243645541369915f, 0.05918695032596588f, -0.14271233975887299f, -0.14930351078510284f, 0.10391119867563248f, -0.07162351906299591f, -0.05258358269929886f, -0.02662455290555954f, -0.004528860095888376f, -0.03453400731086731f, 0.1804865300655365f, -0.051055699586868286f, 0.13550271093845367f, -0.021490154787898064f, 0.11630496382713318f, 0.00032549837487749755f, -0.06447353959083557f, 0.09471168369054794f, -0.13764648139476776f, -0.5060480833053589f, 0.9035472869873047f, -0.7488479614257812f, 0.42480069398880005f, 0.2593879699707031f, 0.1081087663769722f, 0.011803307570517063f, -0.049718260765075684f, 0.039394933730363846f, 0.04787296801805496f, -0.03913772106170654f, -0.0843501016497612f, 0.1086358055472374f, -0.06477988511323929f, 0.00034317970857955515f, -0.03534689173102379f, 0.04332477226853371f, 0.09580539911985397f, -0.004574413411319256f, 0.06707119941711426f, -0.030655305832624435f, 0.026728201657533646f, 0.10853622108697891f, 0.014723243191838264f, -0.016739636659622192f, 0.09244498610496521f, -0.01654014177620411f, 0.009366820566356182f, 0.0487600639462471f, 0.03018810600042343f, 0.09409404546022415f, 0.010155955329537392f, 0.12115904688835144f, 0.029078619554638863f, 0.10831337422132492f, 0.0029707890935242176f, -0.0037105546798557043f, 0.06990272551774979f, 0.0072517311200499535f, 3.545354127883911f, 0.06844430416822433f, 0.25741052627563477f, 0.19108210504055023f, -0.20352105796337128f, 0.14643481373786926f, -0.3229671120643616f, -0.1020800918340683f, -0.08695434033870697f, 0.08643769472837448f, -0.1654130220413208f, -0.043761152774095535f, -0.18538206815719604f, 0.12614256143569946f, -0.11174850165843964f, -0.08199794590473175f, -0.08777284622192383f, 0.047767989337444305f, 0.026947423815727234f, -0.004907058086246252f, 0.07967811822891235f, -0.16153325140476227f, -0.019950054585933685f, 0.020221233367919922f, -0.06871255487203598f, -0.16149815917015076f, 0.03462038189172745f, 0.09595146775245667f, 0.0006536212167702615f, 0.027537807822227478f, -0.04041196405887604f, -0.08309540897607803f, 0.24434888362884521f, -0.06375028192996979f, 0.021879523992538452f, 0.11075283586978912f, -0.061566710472106934f, 0.15356013178825378f, -0.024376092478632927f, 0.023607075214385986f, -0.0961129292845726f, 0.5925861597061157f, 0.06570351123809814f, 0.008205074816942215f, 0.04878285154700279f, -0.12267572432756424f, -0.0858522355556488f, -0.031718287616968155f, -0.01690649800002575f, 0.04448490962386131f, -0.03910379856824875f, -0.023779520764946938f, -0.01929144561290741f, -0.0018078350694850087f, 0.007312134373933077f, 0.0045078513212502f, 0.002027785172685981f, 0.007950262166559696f, -0.007931728847324848f, 0.009073948487639427f, 0.013212854973971844f, -0.010954882018268108f, 0.00848750863224268f, -0.011711355298757553f, 0.016122354194521904f, -0.021200131624937057f, -0.028568260371685028f, 0.002801446709781885f, -0.003135760547593236f, 0.006599594838917255f, 0.0002975752577185631f, -0.008792643435299397f, 0.0016105500981211662f, 0.01141306571662426f, -0.03512351214885712f, -0.024474043399095535f, -0.02830524370074272f, 0.011055934242904186f, -0.010764188133180141f, -0.012313373386859894f, 4.864375114440918f, 0.24305464327335358f, -0.20747560262680054f, -0.40818190574645996f, 0.4215831458568573f, -0.10760501027107239f, -0.04622669517993927f, -0.15199290215969086f, 0.023834900930523872f, 0.09883575886487961f, 0.03842794895172119f, 0.15397396683692932f, 0.07855703681707382f, 0.15423135459423065f, -0.08526275306940079f, 0.08848487585783005f, -0.12301971018314362f, 0.07604221999645233f, -0.019005373120307922f, 0.05327548459172249f, 0.23685599863529205f, -0.1458478569984436f, 0.08793401718139648f, -0.15292224287986755f, 0.08160647004842758f, 0.10873210430145264f, -0.10743073374032974f, 0.08084172010421753f, -0.11746718734502792f, 0.11446041613817215f, -0.00980438757687807f, 0.15358170866966248f, 0.031178314238786697f, 0.20714007318019867f, -0.18525104224681854f, 0.27532875537872314f, 0.026748714968562126f, -0.16692373156547546f, -0.03278666362166405f, -0.013099431991577148f, 3.8236160278320312f, 0.0006325616268441081f, -0.29826709628105164f, 0.05137932300567627f, 0.1174972653388977f, 0.1357157677412033f, -0.04857683926820755f, -0.3328833281993866f, -0.004564566072076559f, 0.15324126183986664f, -0.35642802715301514f, 0.1325371414422989f, -0.02789904735982418f, 0.03023139201104641f, 0.0579884834587574f, 0.21501615643501282f, -0.101333849132061f, 0.15999174118041992f, -0.015511022880673409f, 0.0754990354180336f, 0.08331592381000519f, -0.005808727350085974f, -0.0017095943912863731f, -0.1671171337366104f, 0.08752657473087311f, 0.12125420570373535f, -0.18489514291286469f, 0.17837762832641602f, -0.038224633783102036f, 0.03380017727613449f, 0.03031724877655506f, 0.011734080500900745f, 0.05468198284506798f, 0.0329931303858757f, -0.06868044286966324f, 0.20102986693382263f, 0.07858344912528992f, 0.015481392852962017f, -0.1171475350856781f, 0.07945262640714645f;
bias0 << -0.7281076908111572f, -0.07397522777318954f, -0.05191224440932274f, 0.2929287552833557f, 0.0674399584531784f, 0.2939274311065674f, 1.225870132446289f, -0.9854989051818848f, 0.3182806968688965f, 0.9974460601806641f;
weight2 << 0.1570993810892105f, -0.03971972316503525f, 1.4919440746307373f, 0.4015232026576996f, -0.09081661701202393f, 0.2265753448009491f, 0.00999616738408804f, 0.4700798988342285f, 0.16880673170089722f, 0.009147235192358494f, 0.469729483127594f, -0.47179895639419556f, 1.2642323970794678f, -0.2595731317996979f, -0.2611044645309448f, -0.27896085381507874f, 0.38983154296875f, 0.6744163036346436f, 0.2537330389022827f, -0.22242093086242676f, 1.0386406183242798f, -0.01931389793753624f, 2.18271541595459f, 0.3037821650505066f, 0.5098665952682495f, -0.7140306830406189f, 1.0430500507354736f, 1.7213432788848877f, -0.177284836769104f, 0.16970588266849518f, -1.4903590679168701f, -0.1875862181186676f, 0.5528481602668762f, 0.3272436261177063f, -0.05941716954112053f, 0.13151977956295013f, -0.028842732310295105f, 0.47569167613983154f, 0.008632366545498371f, 0.10281351208686829f, -0.18346284329891205f, 1.0818545818328857f, 0.4664778709411621f, -0.7148606181144714f, 0.19293715059757233f, 0.3732083737850189f, -0.6687629222869873f, 1.9639930725097656f, -0.038746315985918045f, 0.42661628127098083f, 0.09619557857513428f, 0.5864790081977844f, 0.09822020679712296f, 0.06951015442609787f, -0.5428609251976013f, -0.3338289260864258f, 1.0814287662506104f, -0.3917093575000763f, 0.37143221497535706f, -0.40262889862060547f, 0.683214545249939f, -0.7058811187744141f, 1.0794309377670288f, -0.07675304263830185f, -0.14203841984272003f, -0.2454233318567276f, 0.1443963199853897f, -0.7999716997146606f, 0.11054714024066925f, -0.06748629361391068f, 0.5755316615104675f, -0.18603092432022095f, 0.570415198802948f, 0.14469395577907562f, -0.08869614452123642f, 0.30108433961868286f, 0.3023339509963989f, -0.8621297478675842f, 0.6266722679138184f, -0.3152424991130829f, 1.6005114316940308f, -0.13040973246097565f, 0.2976474463939667f, 1.0917692184448242f, -0.44718843698501587f, 0.4611437916755676f, -0.1512860506772995f, 0.5295358896255493f, 0.3651668429374695f, 0.3789008855819702f, -0.8824642896652222f, -0.5054826140403748f, -0.6641855239868164f, -0.025894537568092346f, 0.7407703995704651f, -0.7303745746612549f, 0.6135888695716858f, -0.7271690368652344f, 1.7968460321426392f, -1.353137731552124f;
bias2 << -1.1041300296783447f, 0.2976137101650238f, -0.2740781605243683f, 0.25372254848480225f, -0.7787513732910156f, 0.46091538667678833f, -0.6849841475486755f, -0.7664902210235596f, 0.11691652238368988f, 0.04802748188376427f;
weight4 << 1.9144784212112427f, 0.9188523292541504f, 0.14971823990345f, -0.6077225804328918f, -0.42131468653678894f, -0.3626399040222168f, -0.8259995579719543f, -0.26915672421455383f, 0.16111290454864502f, -0.07948096841573715f, 0.6866346001625061f, -1.559893250465393f, -0.9034400582313538f, -1.946366786956787f, -0.917442798614502f, 0.3986048996448517f, 1.8675662279129028f, 0.19286079704761505f, 0.18551680445671082f, -0.014665993861854076f, 0.5341473817825317f, 1.0608099699020386f, 1.0682320594787598f, -0.6027039289474487f, -1.723584771156311f, -1.3741016387939453f, 0.5894125699996948f, 1.6625295877456665f, -2.2112319469451904f, 1.6004647016525269f;
bias4 << 1.613640308380127f, 0.17835427820682526f, 0.003057967871427536f;
out_mean << 0.5892696258192149, 0.05829819149489351, 0.007179680022101399;
out_std << 0.6453649339897949, 0.3530593688328154, 0.3135598259667661;
in_mean << 0.03462228786869317, -0.10282083100278556, 0.06312058423246462, 9.632316249615396, 9.297293521814149, 0.03462252434363915, -0.10282088846857422, 0.0631207117039123, 9.632309787376483, 9.297293521814149, 0.03462271378442524, -0.10282104123943543, 0.06312023743804132, 9.632309787376483, 9.297293521814149, 0.03462283966465983, -0.10282117599352536, 0.06312022732640432, 9.632309787376483, 9.297287059575234, 0.034623016002246, -0.10282129631608941, 0.06312011502832839, 9.632309787376483, 9.297287059575234, 0.0346234108494525, -0.10282154732699589, 0.06312002496093462, 9.632303325137569, 9.297287059575234, 0.034623345720323995, -0.10282157828691975, 0.06312019204756905, 9.632296862898654, 9.297287059575234, 0.03462347132944016, -0.10282165269220836, 0.0631199986897133, 9.632290400659741, 9.29728059733632;
in_std << 0.6899063711029106, 0.602913329177706, 0.6774506941674773, 3.7502915754781725, 3.5675647482340227, 0.6899063584478309, 0.6029133193242553, 0.6774506820573597, 3.7503080649431806, 3.5675647482340227, 0.6899063484352683, 0.6029132928944531, 0.6774507230194722, 3.7503080649431806, 3.5675647482340227, 0.6899063418947754, 0.6029132696207097, 0.677450723960141, 3.750308064943181, 3.5675814754147854, 0.6899063326072289, 0.6029132488674407, 0.6774507342423767, 3.750308064943182, 3.5675814754147854, 0.6899063105953815, 0.6029132050441208, 0.6774507425178393, 3.750324554324448, 3.567581475414786, 0.6899063138041703, 0.6029131997487247, 0.6774507265493568, 3.750341043622047, 3.567581475414786, 0.6899063072781266, 0.6029131869703065, 0.6774507440287089, 3.750357532836168, 3.5675982025056063;
}

Eigen::Matrix<float,NNResModel::num_out_features,1> NNResModel::forward(Eigen::Matrix<float,NNResModel::num_in_features,1> features){
  Eigen::Matrix<float,NNResModel::num_hidden_nodes,1> layer0_out;
  Eigen::Matrix<float,NNResModel::num_hidden_nodes,1> layer2_out;
  Eigen::Matrix<float,NNResModel::num_out_features,1> layer4_out;
  Eigen::Matrix<float,NNResModel::num_out_features,1> labels;
  Eigen::Matrix<float,NNResModel::num_in_features,1> scaled_features;
  
  scaled_features = (features - in_mean).cwiseQuotient(in_std);
  layer0_out = (weight0*scaled_features) + bias0;
  layer0_out = layer0_out.unaryExpr(&tanhf);
  layer2_out = (weight2*layer0_out) + bias2;
  layer2_out = layer2_out.unaryExpr(&tanhf);
  layer4_out = (weight4*layer2_out) + bias4;        
  labels = layer4_out.cwiseProduct(out_std) + out_mean;

  return labels;
}
